<div class="container7">
<span><%= link_to "Go back", farms_path %><span>
</div>
<div class="text-center">

  <div class="title-farm">
    <h2><%= @farm.name %></h2>

  </div>
  <div class="card-farm-show">
    <%= cl_image_tag @farm.photo.key, height: 800, class: "img-farm" %>
    <p><%= @farm.description %></p>
  </div>
  <div class="card-footer-farm">
  </div>
</div>
<div class="container">
<h2>Our Farm's Produce:</h2>
  <div class="row">
    <% @farm.products.each do |product| %>
      <div class="col-6">
        <div class="card-product">
          <div class="d-flex align-items-center">
            <h3>
              <%= link_to product.name, product_path(product), class: "product-link" %>
              <% if product.farm.user == current_user %>
                <%= link_to product_path(product), method: :delete, data: {confirm: "Are you sure you would like to delete this product?"} do %>
                  <div clas="container">
                  <i class="fas fa-trash"></i>
                  </div>
                <% end %>
              <% end %>
            </h3>
            <div>
              <%= cl_image_tag product.photo.key, height: 800, crop: :fill %>
              <h6>Â£<%= product.price %></h6>
            </div>
          </div>

          <div class="container03 justify-content-center">
            <% unless current_user.orders.first.products.include?(product) %>
              <%= simple_form_for [product, @order_product] do |f| %>
                <%= f.input :quantity, as: :hidden, input_html: {value: 1} %>
                <span><%= f.submit "Add to basket"%><span>
              <% end %>
              <% else %>
                <% order_product = OrderProduct.where(order: current_user.orders.first, product: product).first %>
                <div>
                <% if order_product.quantity > 1 %>
                  <%= link_to '-', decrease_quantity_order_product_path(order_product, quantity: order_product.quantity), method: :post %>
                <% end %>
                <div class="container01">
                  <%= order_product.quantity%>
                </div>
                <%= link_to '+', increase_quantity_order_product_path(order_product, quantity: order_product.quantity), method: :post %>
                </div>
              <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
  <% if @farm.user == current_user %>
  <div class="container w-50">
    <br>
    <h3>Add a new product to your farm</h3>
      <%= simple_form_for [@farm, @product] do |f| %>
      <div class="container03 justify-content-center">
      <%= f.input :name %>
      </div>
      <div class="container03 justify-content-center">
      <%= f.input :price %>
      </div>
      <div class="container03 justify-content-center">
      <%= f.input :category, collection: @categories %>
      </div>
      <div class="container03 justify-content-center">
      <%= f.input :description %>
      </div>
      <div class="container03 justify-content-center">
      <%= f.input :photo, as: :file %>
      </div>
       <span><div class="form-actions"><span>
        <div class="container03 justify-content-center">
      <%= f.submit "Create product" %>
      <div>
      </div>
      <% end %>
  </div>
<% end %>

<%= javascript_pack_tag 'my_js' %>
</div>
